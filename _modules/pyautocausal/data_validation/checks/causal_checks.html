<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyautocausal.data_validation.checks.causal_checks &mdash; PyAutoCausal 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            PyAutoCausal
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting-started.html">Getting Started with PyAutoCausal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#your-first-analysis-feature-rollout-impact">Your First Analysis: Feature Rollout Impact</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#step-1-prepare-your-data">Step 1: Prepare Your Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#step-2-run-the-analysis">Step 2: Run the Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#step-3-examine-the-results">Step 3: Examine the Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#step-4-interpret-your-results">Step 4: Interpret Your Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#understanding-what-pyautocausal-did">Understanding What PyAutoCausal Did</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#common-data-scenarios">Common Data Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#scenario-1-single-time-period-cross-sectional">Scenario 1: Single Time Period (Cross-sectional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#scenario-2-single-treated-unit">Scenario 2: Single Treated Unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#scenario-3-large-dataset">Scenario 3: Large Dataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../getting-started.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#common-issues">Common Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../getting-started.html#getting-help">Getting Help</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../data-requirements.html">Data Requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#core-data-structure">Core Data Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#required-columns">Required Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#optional-columns">Optional Columns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#example-dataset-structure">Example Dataset Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#data-formatting-requirements">Data Formatting Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#treatment-variable-treat">1. Treatment Variable (<code class="docutils literal notranslate"><span class="pre">treat</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#time-variable-t">2. Time Variable (<code class="docutils literal notranslate"><span class="pre">t</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#unit-id-id-unit">3. Unit ID (<code class="docutils literal notranslate"><span class="pre">id_unit</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#missing-values">4. Missing Values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#common-data-scenarios">Common Data Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#scenario-1-staggered-treatment-adoption">Scenario 1: Staggered Treatment Adoption</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#scenario-2-geographic-policy-analysis">Scenario 2: Geographic Policy Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#scenario-3-marketing-campaign-analysis">Scenario 3: Marketing Campaign Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#data-validation">Data Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#common-validation-issues">Common Validation Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#data-size-considerations">Data Size Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#minimum-requirements">Minimum Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#performance-guidelines">Performance Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data-requirements.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#data-quality">1. Data Quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#treatment-timing">2. Treatment Timing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../data-requirements.html#outcome-variable">3. Outcome Variable</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Example Pipelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#example-1-california-proposition-99-synthetic-control">Example 1: California Proposition 99 (Synthetic Control)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#dataset">Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#what-the-pipeline-does">What the Pipeline Does</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#pipeline-execution-graph">Pipeline Execution Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#key-results">Key Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#example-2-minimum-wage-study-staggered-did">Example 2: Minimum Wage Study (Staggered DiD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#id1">Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#id2">What the Pipeline Does</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#id3">Pipeline Execution Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#id4">Key Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#understanding-the-graph-visualization">Understanding the Graph Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#node-types">Node Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../examples.html#node-states">Node States</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../examples.html#running-your-own-analysis">Running Your Own Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#module-pyautocausal.orchestration.graph">Orchestration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.__init__"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.configure_runtime"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.configure_runtime()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.input_nodes"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.input_nodes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_ready_nodes"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_ready_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_running_nodes"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_running_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.is_execution_finished"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.is_execution_finished()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_incomplete_nodes"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_incomplete_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.save_node_output"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.save_node_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.execute_graph"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.execute_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.fit"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.create_node"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.create_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.add_node_to_graph"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.add_node_to_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.add_node"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.add_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.create_input_node"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.create_input_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.merge_with"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.merge_with()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.to_text"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.to_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.print_graph"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.print_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_node_predecessors"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_node_predecessors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_node_successors"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_node_successors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.get_node_predecessor_outputs"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.get_node_predecessor_outputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.is_node_ready"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.is_node_ready()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.validate_node_graph_consistency"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.validate_node_graph_consistency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.can_wire_nodes"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.can_wire_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.add_node_with_predecessors"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.add_node_with_predecessors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.add_edge"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.add_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.create_decision_node"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.create_decision_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.when_true"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.when_true()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.when_false"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.when_false()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.__getstate__"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.__getstate__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.__setstate__"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.__setstate__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.to_yaml"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.to_yaml()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.graph.ExecutableGraph.from_yaml"><code class="docutils literal notranslate"><span class="pre">ExecutableGraph.from_yaml()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.NodeExecutionError"><code class="docutils literal notranslate"><span class="pre">NodeExecutionError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.NodeExecutionError.__init__"><code class="docutils literal notranslate"><span class="pre">NodeExecutionError.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.is_lambda"><code class="docutils literal notranslate"><span class="pre">is_lambda()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.BaseNode"><code class="docutils literal notranslate"><span class="pre">BaseNode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.BaseNode.__init__"><code class="docutils literal notranslate"><span class="pre">BaseNode.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node"><code class="docutils literal notranslate"><span class="pre">Node</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.__init__"><code class="docutils literal notranslate"><span class="pre">Node.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.validate_action_function_static"><code class="docutils literal notranslate"><span class="pre">Node.validate_action_function_static()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.__rshift__"><code class="docutils literal notranslate"><span class="pre">Node.__rshift__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.execute"><code class="docutils literal notranslate"><span class="pre">Node.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.mark_running"><code class="docutils literal notranslate"><span class="pre">Node.mark_running()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.mark_completed"><code class="docutils literal notranslate"><span class="pre">Node.mark_completed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.mark_failed"><code class="docutils literal notranslate"><span class="pre">Node.mark_failed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.mark_passed"><code class="docutils literal notranslate"><span class="pre">Node.mark_passed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.is_completed"><code class="docutils literal notranslate"><span class="pre">Node.is_completed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.is_running"><code class="docutils literal notranslate"><span class="pre">Node.is_running()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.is_passed"><code class="docutils literal notranslate"><span class="pre">Node.is_passed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.Node.get_result_value"><code class="docutils literal notranslate"><span class="pre">Node.get_result_value()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode"><code class="docutils literal notranslate"><span class="pre">DecisionNode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.__init__"><code class="docutils literal notranslate"><span class="pre">DecisionNode.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.add_execute_when_true"><code class="docutils literal notranslate"><span class="pre">DecisionNode.add_execute_when_true()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.add_execute_when_false"><code class="docutils literal notranslate"><span class="pre">DecisionNode.add_execute_when_false()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.validate_branches"><code class="docutils literal notranslate"><span class="pre">DecisionNode.validate_branches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.condition_satisfied"><code class="docutils literal notranslate"><span class="pre">DecisionNode.condition_satisfied()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.DecisionNode.mark_unreachable_nodes_as_passed"><code class="docutils literal notranslate"><span class="pre">DecisionNode.mark_unreachable_nodes_as_passed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.InputNode"><code class="docutils literal notranslate"><span class="pre">InputNode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.InputNode.__init__"><code class="docutils literal notranslate"><span class="pre">InputNode.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.nodes.InputNode.set_input"><code class="docutils literal notranslate"><span class="pre">InputNode.set_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node"><code class="docutils literal notranslate"><span class="pre">Node</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.name"><code class="docutils literal notranslate"><span class="pre">Node.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.output"><code class="docutils literal notranslate"><span class="pre">Node.output</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.output_config"><code class="docutils literal notranslate"><span class="pre">Node.output_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.is_running"><code class="docutils literal notranslate"><span class="pre">Node.is_running()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.is_completed"><code class="docutils literal notranslate"><span class="pre">Node.is_completed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.execute"><code class="docutils literal notranslate"><span class="pre">Node.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.orchestration.base.Node.__init__"><code class="docutils literal notranslate"><span class="pre">Node.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#module-pyautocausal.pipelines.library.specifications">Pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.BaseSpec"><code class="docutils literal notranslate"><span class="pre">BaseSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.BaseSpec.data"><code class="docutils literal notranslate"><span class="pre">BaseSpec.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.BaseSpec.formula"><code class="docutils literal notranslate"><span class="pre">BaseSpec.formula</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.BaseSpec.__init__"><code class="docutils literal notranslate"><span class="pre">BaseSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.CrossSectionalSpec"><code class="docutils literal notranslate"><span class="pre">CrossSectionalSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.CrossSectionalSpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">CrossSectionalSpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.CrossSectionalSpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">CrossSectionalSpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.CrossSectionalSpec.control_cols"><code class="docutils literal notranslate"><span class="pre">CrossSectionalSpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.CrossSectionalSpec.__init__"><code class="docutils literal notranslate"><span class="pre">CrossSectionalSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec"><code class="docutils literal notranslate"><span class="pre">DiDSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">DiDSpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">DiDSpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.control_cols"><code class="docutils literal notranslate"><span class="pre">DiDSpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.time_col"><code class="docutils literal notranslate"><span class="pre">DiDSpec.time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.unit_col"><code class="docutils literal notranslate"><span class="pre">DiDSpec.unit_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.post_col"><code class="docutils literal notranslate"><span class="pre">DiDSpec.post_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.include_unit_fe"><code class="docutils literal notranslate"><span class="pre">DiDSpec.include_unit_fe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.include_time_fe"><code class="docutils literal notranslate"><span class="pre">DiDSpec.include_time_fe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.model"><code class="docutils literal notranslate"><span class="pre">DiDSpec.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.DiDSpec.__init__"><code class="docutils literal notranslate"><span class="pre">DiDSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec"><code class="docutils literal notranslate"><span class="pre">EventStudySpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.control_cols"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.time_col"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.unit_col"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.unit_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.relative_time_col"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.relative_time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.event_cols"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.event_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.reference_period"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.reference_period</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.model"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.EventStudySpec.__init__"><code class="docutils literal notranslate"><span class="pre">EventStudySpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.control_cols"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.time_col"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.unit_col"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.unit_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.treatment_time_col"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.treatment_time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.model"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.StaggeredDiDSpec.__init__"><code class="docutils literal notranslate"><span class="pre">StaggeredDiDSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.control_cols"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.time_col"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.time_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.unit_col"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.unit_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.Y"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.Y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.N0"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.N0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.T0"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.T0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.X"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.X</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.model"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.SynthDIDSpec.__init__"><code class="docutils literal notranslate"><span class="pre">SynthDIDSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec"><code class="docutils literal notranslate"><span class="pre">UpliftSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.outcome_col"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.outcome_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.treatment_cols"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.treatment_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.control_cols"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.control_cols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.unit_col"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.unit_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.model"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.propensity_score"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.propensity_score</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.cate_estimates"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.cate_estimates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.ate_estimate"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.ate_estimate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.ate_ci"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.ate_ci</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.model_type"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.model_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.models"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.models</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.evaluation_metrics"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.evaluation_metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.UpliftSpec.__init__"><code class="docutils literal notranslate"><span class="pre">UpliftSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.validate_and_prepare_data"><code class="docutils literal notranslate"><span class="pre">validate_and_prepare_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.specifications.spec_constructor"><code class="docutils literal notranslate"><span class="pre">spec_constructor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.estimators.create_model_matrices"><code class="docutils literal notranslate"><span class="pre">create_model_matrices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.estimators.extract_treatment_from_design"><code class="docutils literal notranslate"><span class="pre">extract_treatment_from_design()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.conditions.is_continuous"><code class="docutils literal notranslate"><span class="pre">is_continuous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.conditions.index_relative_time"><code class="docutils literal notranslate"><span class="pre">index_relative_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.conditions.has_binary_treatment_and_outcome"><code class="docutils literal notranslate"><span class="pre">has_binary_treatment_and_outcome()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.pipelines.library.plots.create_did_plot"><code class="docutils literal notranslate"><span class="pre">create_did_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#causal-methods">Causal Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#module-pyautocausal.persistence.output_config">Persistence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_config.OutputConfig"><code class="docutils literal notranslate"><span class="pre">OutputConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_config.OutputConfig.output_type"><code class="docutils literal notranslate"><span class="pre">OutputConfig.output_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_config.OutputConfig.output_filename"><code class="docutils literal notranslate"><span class="pre">OutputConfig.output_filename</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_config.OutputConfig.__post_init__"><code class="docutils literal notranslate"><span class="pre">OutputConfig.__post_init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_config.OutputConfig.__init__"><code class="docutils literal notranslate"><span class="pre">OutputConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.UnsupportedOutputTypeError"><code class="docutils literal notranslate"><span class="pre">UnsupportedOutputTypeError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler"><code class="docutils literal notranslate"><span class="pre">OutputHandler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.SAVE_METHOD_MAP"><code class="docutils literal notranslate"><span class="pre">OutputHandler.SAVE_METHOD_MAP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.__init__"><code class="docutils literal notranslate"><span class="pre">OutputHandler.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_csv"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_parquet"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_parquet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_json"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_pickle"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_pickle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_text"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_png"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_png()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.output_handler.OutputHandler.save_bytes"><code class="docutils literal notranslate"><span class="pre">OutputHandler.save_bytes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.notebook_export.NotebookExporter"><code class="docutils literal notranslate"><span class="pre">NotebookExporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.notebook_export.NotebookExporter.__init__"><code class="docutils literal notranslate"><span class="pre">NotebookExporter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.notebook_export.NotebookExporter.export_notebook"><code class="docutils literal notranslate"><span class="pre">NotebookExporter.export_notebook()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.notebook_export.NotebookExporter.export_and_run_to_html"><code class="docutils literal notranslate"><span class="pre">NotebookExporter.export_and_run_to_html()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.persistence.notebook_export.NotebookExporter.run_existing_notebook_to_html"><code class="docutils literal notranslate"><span class="pre">NotebookExporter.run_existing_notebook_to_html()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#module-pyautocausal.data_validation.validator_base">Data Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidationError"><code class="docutils literal notranslate"><span class="pre">DataValidationError</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidationError.__init__"><code class="docutils literal notranslate"><span class="pre">DataValidationError.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidationError.__str__"><code class="docutils literal notranslate"><span class="pre">DataValidationError.__str__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.passed"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.passed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.individual_results"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.individual_results</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.summary"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#id0"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.passed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#id1"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.individual_results</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#id2"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.__post_init__"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.__post_init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.get_all_issues"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.get_all_issues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.get_failed_checks"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.get_failed_checks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.to_string"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.to_string()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.AggregatedValidationResult.__init__"><code class="docutils literal notranslate"><span class="pre">AggregatedValidationResult.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig.fail_on_warning"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig.fail_on_warning</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig.aggregation_strategy"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig.aggregation_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig.check_configs"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig.check_configs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig.enabled_checks"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig.enabled_checks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidatorConfig.__init__"><code class="docutils literal notranslate"><span class="pre">DataValidatorConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidator"><code class="docutils literal notranslate"><span class="pre">DataValidator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidator.__init__"><code class="docutils literal notranslate"><span class="pre">DataValidator.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidator.validate"><code class="docutils literal notranslate"><span class="pre">DataValidator.validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.validator_base.DataValidator.__call__"><code class="docutils literal notranslate"><span class="pre">DataValidator.__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataConfig"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataConfig.min_rows"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataConfig.min_rows</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataConfig.min_columns"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataConfig.min_columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataConfig.__init__"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataCheck"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataCheck.name"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NonEmptyDataCheck.validate"><code class="docutils literal notranslate"><span class="pre">NonEmptyDataCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsConfig"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsConfig.required_columns"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsConfig.required_columns</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsConfig.case_sensitive"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsConfig.case_sensitive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsConfig.__init__"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsCheck"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsCheck.name"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.RequiredColumnsCheck.validate"><code class="docutils literal notranslate"><span class="pre">RequiredColumnsCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesConfig"><code class="docutils literal notranslate"><span class="pre">ColumnTypesConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesConfig.expected_types"><code class="docutils literal notranslate"><span class="pre">ColumnTypesConfig.expected_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesConfig.type_checkers"><code class="docutils literal notranslate"><span class="pre">ColumnTypesConfig.type_checkers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ColumnTypesConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesCheck"><code class="docutils literal notranslate"><span class="pre">ColumnTypesCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesCheck.name"><code class="docutils literal notranslate"><span class="pre">ColumnTypesCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">ColumnTypesCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.ColumnTypesCheck.validate"><code class="docutils literal notranslate"><span class="pre">ColumnTypesCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsConfig"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsConfig.case_sensitive"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsConfig.case_sensitive</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsConfig.__init__"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsCheck"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsCheck.name"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.NoDuplicateColumnsCheck.validate"><code class="docutils literal notranslate"><span class="pre">NoDuplicateColumnsCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsConfig"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsConfig.subset"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsConfig.subset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsConfig.keep"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsConfig.keep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsConfig.max_duplicate_fraction"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsConfig.max_duplicate_fraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsConfig.__init__"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsCheck"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsCheck.name"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.basic_checks.DuplicateRowsCheck.validate"><code class="docutils literal notranslate"><span class="pre">DuplicateRowsCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig.allow_missing"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentConfig.allow_missing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig.valid_values"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentConfig.valid_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig.__init__"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck.name"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck.validate"><code class="docutils literal notranslate"><span class="pre">BinaryTreatmentCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.min_treated_fraction"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.min_treated_fraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.max_treated_fraction"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.max_treated_fraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.min_treated_count"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.min_treated_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.min_control_count"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.min_control_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig.__init__"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck.name"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck.validate"><code class="docutils literal notranslate"><span class="pre">TreatmentVariationCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig.unit_column"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig.unit_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig.time_column"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig.require_balanced"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig.require_balanced</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig.__init__"><code class="docutils literal notranslate"><span class="pre">PanelStructureConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck"><code class="docutils literal notranslate"><span class="pre">PanelStructureCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck.name"><code class="docutils literal notranslate"><span class="pre">PanelStructureCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">PanelStructureCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck.validate"><code class="docutils literal notranslate"><span class="pre">PanelStructureCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig.time_column"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig.require_sequential"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig.require_sequential</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig.require_numeric"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig.require_numeric</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig.date_format"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig.date_format</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig.__init__"><code class="docutils literal notranslate"><span class="pre">TimeColumnConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck"><code class="docutils literal notranslate"><span class="pre">TimeColumnCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck.name"><code class="docutils literal notranslate"><span class="pre">TimeColumnCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">TimeColumnCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck.validate"><code class="docutils literal notranslate"><span class="pre">TimeColumnCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig.unit_column"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig.unit_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig.time_column"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig.allow_treatment_reversals"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig.allow_treatment_reversals</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig.__init__"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck.name"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck.validate"><code class="docutils literal notranslate"><span class="pre">TreatmentPersistenceCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig.outcome_column"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig.outcome_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig.min_variation_threshold"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig.min_variation_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig.outlier_threshold"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig.outlier_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig.require_numeric"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig.require_numeric</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig.__init__"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck.name"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck.validate"><code class="docutils literal notranslate"><span class="pre">OutcomeVariableCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.unit_column"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.unit_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.time_column"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.min_pre_periods"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.min_pre_periods</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.min_post_periods"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.min_post_periods</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.min_control_units"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.min_control_units</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.min_never_treated_fraction"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.min_never_treated_fraction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig.__init__"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck.name"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck.validate"><code class="docutils literal notranslate"><span class="pre">CausalMethodRequirementsCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig.unit_column"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig.unit_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig.time_column"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig.check_simultaneous_adoption"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig.check_simultaneous_adoption</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig.__init__"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck.name"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck.validate"><code class="docutils literal notranslate"><span class="pre">TreatmentTimingPatternsCheck.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationConfig"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationConfig.treatment_column"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationConfig.treatment_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationConfig.time_column"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationConfig.time_column</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationConfig.__init__"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationCheck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck.name"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationCheck.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck.get_default_config"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationCheck.get_default_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck.validate"><code class="docutils literal notranslate"><span class="pre">TimePeriodStandardizationCheck.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/index.html#module-pyautocausal.data_cleaning.cleaner">Data Cleaning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.cleaner.DataCleaner"><code class="docutils literal notranslate"><span class="pre">DataCleaner</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.cleaner.DataCleaner.__init__"><code class="docutils literal notranslate"><span class="pre">DataCleaner.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.cleaner.DataCleaner.clean"><code class="docutils literal notranslate"><span class="pre">DataCleaner.clean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.cleaner.DataCleaner.__call__"><code class="docutils literal notranslate"><span class="pre">DataCleaner.__call__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.planner.DataCleaningPlanner"><code class="docutils literal notranslate"><span class="pre">DataCleaningPlanner</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.planner.DataCleaningPlanner.__init__"><code class="docutils literal notranslate"><span class="pre">DataCleaningPlanner.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.planner.DataCleaningPlanner.create_plan"><code class="docutils literal notranslate"><span class="pre">DataCleaningPlanner.create_plan()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../api/index.html#pyautocausal.data_cleaning.planner.DataCleaningPlanner.__call__"><code class="docutils literal notranslate"><span class="pre">DataCleaningPlanner.__call__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">PyAutoCausal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyautocausal.data_validation.checks.causal_checks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyautocausal.data_validation.checks.causal_checks</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Causal inference specific validation checks for pandas DataFrames.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">DataValidationCheck</span><span class="p">,</span>
    <span class="n">DataValidationConfig</span><span class="p">,</span>
    <span class="n">DataValidationResult</span><span class="p">,</span>
    <span class="n">ValidationIssue</span><span class="p">,</span>
    <span class="n">ValidationSeverity</span>
<span class="p">)</span>


<div class="viewcode-block" id="BinaryTreatmentConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BinaryTreatmentConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for BinaryTreatmentCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">allow_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">valid_values</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">})</span></div>



<div class="viewcode-block" id="BinaryTreatmentCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BinaryTreatmentCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">BinaryTreatmentConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that treatment variable is binary (0/1).&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;binary_treatment&quot;</span>
    
<div class="viewcode-block" id="BinaryTreatmentCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BinaryTreatmentConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">BinaryTreatmentConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="BinaryTreatmentCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.BinaryTreatmentCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check if treatment column exists</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">treatment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span>
        
        <span class="c1"># Check for missing values</span>
        <span class="n">missing_count</span> <span class="o">=</span> <span class="n">treatment</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">missing_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">allow_missing</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment column has </span><span class="si">{</span><span class="n">missing_count</span><span class="si">}</span><span class="s2"> missing values&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">missing_count</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="c1"># Check values are in valid set</span>
        <span class="n">unique_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">treatment</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">invalid_values</span> <span class="o">=</span> <span class="n">unique_values</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">valid_values</span>
        
        <span class="k">if</span> <span class="n">invalid_values</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment column contains invalid values: </span><span class="si">{</span><span class="n">invalid_values</span><span class="si">}</span><span class="s2">. Expected: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">valid_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;invalid_values&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">invalid_values</span><span class="p">),</span>
                    <span class="s2">&quot;valid_values&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">valid_values</span><span class="p">),</span>
                    <span class="s2">&quot;unique_values&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Calculate treatment statistics</span>
        <span class="n">value_counts</span> <span class="o">=</span> <span class="n">treatment</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        
        <span class="c1"># Calculate treatment fraction only if treatment column is numeric and has valid values</span>
        <span class="n">treatment_fraction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Only calculate fraction if treatment contains numeric values</span>
                <span class="n">numeric_treatment</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">treatment</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">numeric_treatment</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                    <span class="n">treatment_fraction</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">numeric_treatment</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">numeric_treatment</span><span class="o">.</span><span class="n">dropna</span><span class="p">()))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="c1"># If conversion fails, leave treatment_fraction as None</span>
                <span class="k">pass</span>
        
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;treatment_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span>
            <span class="s2">&quot;unique_values&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_values</span><span class="p">),</span>
            <span class="s2">&quot;value_counts&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="s2">&quot;missing_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">missing_count</span><span class="p">),</span>
            <span class="s2">&quot;treatment_fraction&quot;</span><span class="p">:</span> <span class="n">treatment_fraction</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TreatmentVariationConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentVariationConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TreatmentVariationCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">min_treated_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Minimum fraction of treated units</span>
    <span class="n">max_treated_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span>  <span class="c1"># Maximum fraction of treated units</span>
    <span class="n">min_treated_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Minimum number of treated units</span>
    <span class="n">min_control_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Minimum number of control units</span></div>



<div class="viewcode-block" id="TreatmentVariationCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentVariationCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">TreatmentVariationConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that there is sufficient variation in treatment assignment.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;treatment_variation&quot;</span>
    
<div class="viewcode-block" id="TreatmentVariationCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreatmentVariationConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TreatmentVariationConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TreatmentVariationCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentVariationCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check if treatment column exists</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">treatment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        
        <span class="c1"># Count treated and control units</span>
        <span class="n">treated_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">treatment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">control_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">treatment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">total_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">total_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No non-missing treatment values found&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">treated_fraction</span> <span class="o">=</span> <span class="n">treated_count</span> <span class="o">/</span> <span class="n">total_count</span>
        
        <span class="c1"># Check minimum counts</span>
        <span class="k">if</span> <span class="n">treated_count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_count</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Only </span><span class="si">{</span><span class="n">treated_count</span><span class="si">}</span><span class="s2"> treated units, minimum required is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;treated_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">treated_count</span><span class="p">),</span> <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_count</span><span class="p">}</span>
            <span class="p">))</span>
        
        <span class="k">if</span> <span class="n">control_count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_count</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Only </span><span class="si">{</span><span class="n">control_count</span><span class="si">}</span><span class="s2"> control units, minimum required is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;control_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">control_count</span><span class="p">),</span> <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_count</span><span class="p">}</span>
            <span class="p">))</span>
        
        <span class="c1"># Check treatment fraction</span>
        <span class="k">if</span> <span class="n">treated_fraction</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_fraction</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment fraction </span><span class="si">{</span><span class="n">treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> is below minimum </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;treated_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">treated_fraction</span><span class="p">),</span>
                    <span class="s2">&quot;min_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_treated_fraction</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="k">if</span> <span class="n">treated_fraction</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_treated_fraction</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment fraction </span><span class="si">{</span><span class="n">treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> is above maximum </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;treated_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">treated_fraction</span><span class="p">),</span>
                    <span class="s2">&quot;max_fraction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_treated_fraction</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;treated_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">treated_count</span><span class="p">),</span>
            <span class="s2">&quot;control_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">control_count</span><span class="p">),</span>
            <span class="s2">&quot;total_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_count</span><span class="p">),</span>
            <span class="s2">&quot;treated_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">treated_fraction</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PanelStructureConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PanelStructureConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for PanelStructureCheck.&quot;&quot;&quot;</span>
    <span class="n">unit_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unit_id&quot;</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>  <span class="c1"># Treatment column for monotonicity check</span>
    <span class="n">require_balanced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Whether to require balanced panel</span></div>



<div class="viewcode-block" id="PanelStructureCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PanelStructureCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">PanelStructureConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check panel data structure for causal analysis.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;panel_structure&quot;</span>
    
<div class="viewcode-block" id="PanelStructureCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PanelStructureConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PanelStructureConfig</span><span class="p">()</span></div>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_required_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ValidationIssue</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that required columns exist in the dataframe.&quot;&quot;&quot;</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check required columns exist</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="s2">&quot;unit&quot;</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> column &#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
                <span class="p">))</span>
        
        <span class="c1"># Check treatment column exists if specified</span>
        <span class="n">treatment_col_exists</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">treatment_col_exists</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="k">return</span> <span class="n">issues</span><span class="p">,</span> <span class="n">treatment_col_exists</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_panel_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ValidationIssue</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check panel structure for duplicates and balance.&quot;&quot;&quot;</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_units</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="n">n_times</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
        
        <span class="c1"># Check for duplicate unit-time observations</span>
        <span class="n">duplicates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">dup_count</span> <span class="o">=</span> <span class="n">duplicates</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">sample_dups</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">duplicates</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="n">dup_count</span><span class="si">}</span><span class="s2"> duplicate unit-time observations&quot;</span><span class="p">,</span>
                <span class="n">affected_rows</span><span class="o">=</span><span class="n">sample_dups</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;duplicate_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">dup_count</span><span class="p">),</span>
                    <span class="s2">&quot;sample_duplicates&quot;</span><span class="p">:</span> <span class="n">sample_dups</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="c1"># Check if panel is balanced</span>
        <span class="n">expected_obs</span> <span class="o">=</span> <span class="n">n_units</span> <span class="o">*</span> <span class="n">n_times</span>
        <span class="n">actual_obs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]))</span>
        <span class="n">is_balanced</span> <span class="o">=</span> <span class="n">expected_obs</span> <span class="o">==</span> <span class="n">actual_obs</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">require_balanced</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_balanced</span><span class="p">:</span>
            <span class="c1"># Find missing observations</span>
            <span class="n">all_combinations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">units</span><span class="p">,</span> <span class="n">times</span><span class="p">],</span> 
                                                        <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">])</span>
            <span class="n">existing_combinations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span>
                <span class="n">df</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">missing_combinations</span> <span class="o">=</span> <span class="n">all_combinations</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">existing_combinations</span><span class="p">)</span>
            
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Panel is unbalanced: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_combinations</span><span class="p">)</span><span class="si">}</span><span class="s2"> unit-time combinations missing&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;expected_observations&quot;</span><span class="p">:</span> <span class="n">expected_obs</span><span class="p">,</span>
                    <span class="s2">&quot;actual_observations&quot;</span><span class="p">:</span> <span class="n">actual_obs</span><span class="p">,</span>
                    <span class="s2">&quot;missing_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_combinations</span><span class="p">),</span>
                    <span class="s2">&quot;sample_missing&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">missing_combinations</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="k">return</span> <span class="n">issues</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_treatment_monotonicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">treatment_col_exists</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ValidationIssue</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check treatment monotonicity for each unit.&quot;&quot;&quot;</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span> <span class="ow">and</span> <span class="n">treatment_col_exists</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">issues</span>
        
        <span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">])</span>
        <span class="n">violations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">unit_data</span> <span class="o">=</span> <span class="n">df_sorted</span><span class="p">[</span><span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span> <span class="o">==</span> <span class="n">unit</span><span class="p">]</span>
            <span class="n">treatment_sequence</span> <span class="o">=</span> <span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            
            <span class="c1"># Check monotonicity: once treated (1), should remain treated</span>
            <span class="n">treated_once</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">treatment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">treatment_sequence</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">treatment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">treated_once</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">treated_once</span> <span class="ow">and</span> <span class="n">treatment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Found violation: unit was treated but then reverted to control</span>
                    <span class="n">violations</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">unit</span><span class="p">,</span>
                        <span class="s2">&quot;violation_at_time&quot;</span><span class="p">:</span> <span class="n">unit_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                        <span class="s2">&quot;treatment_sequence&quot;</span><span class="p">:</span> <span class="n">treatment_sequence</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="p">})</span>
                    <span class="k">break</span>  <span class="c1"># Only report first violation per unit</span>
        
        <span class="k">if</span> <span class="n">violations</span><span class="p">:</span>
            <span class="n">sample_violations</span> <span class="o">=</span> <span class="n">violations</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Show up to 5 examples</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment monotonicity violated for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">violations</span><span class="p">)</span><span class="si">}</span><span class="s2"> units&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;violation_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">violations</span><span class="p">),</span>
                    <span class="s2">&quot;sample_violations&quot;</span><span class="p">:</span> <span class="n">sample_violations</span><span class="p">,</span>
                    <span class="s2">&quot;treatment_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="k">return</span> <span class="n">issues</span>
    
<div class="viewcode-block" id="PanelStructureCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.PanelStructureCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check required columns exist</span>
        <span class="n">missing_cols_issues</span><span class="p">,</span> <span class="n">treatment_col_exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_required_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">missing_cols_issues</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">issues</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Get unique units and time periods</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">times</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">n_units</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="n">n_times</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
        
        <span class="c1"># Check panel structure (duplicates and balance)</span>
        <span class="n">panel_issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_panel_structure</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">times</span><span class="p">)</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">panel_issues</span><span class="p">)</span>
        
        <span class="c1"># Check treatment monotonicity if treatment column is available</span>
        <span class="n">monotonicity_issues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_treatment_monotonicity</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">treatment_col_exists</span><span class="p">)</span>
        <span class="n">issues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">monotonicity_issues</span><span class="p">)</span>
        
        <span class="c1"># Calculate balance for metadata</span>
        <span class="n">expected_obs</span> <span class="o">=</span> <span class="n">n_units</span> <span class="o">*</span> <span class="n">n_times</span>
        <span class="n">actual_obs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]))</span>
        <span class="n">is_balanced</span> <span class="o">=</span> <span class="n">expected_obs</span> <span class="o">==</span> <span class="n">actual_obs</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_units&quot;</span><span class="p">:</span> <span class="n">n_units</span><span class="p">,</span>
            <span class="s2">&quot;n_times&quot;</span><span class="p">:</span> <span class="n">n_times</span><span class="p">,</span>
            <span class="s2">&quot;n_observations&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span>
            <span class="s2">&quot;is_balanced&quot;</span><span class="p">:</span> <span class="n">is_balanced</span><span class="p">,</span>
            <span class="s2">&quot;balance_ratio&quot;</span><span class="p">:</span> <span class="n">actual_obs</span> <span class="o">/</span> <span class="n">expected_obs</span> <span class="k">if</span> <span class="n">expected_obs</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TimeColumnConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeColumnConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TimeColumnCheck.&quot;&quot;&quot;</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">require_sequential</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Whether time periods should be sequential</span>
    <span class="n">require_numeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether time should be numeric</span>
    <span class="n">date_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Expected date format if time is string</span></div>



<div class="viewcode-block" id="TimeColumnCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeColumnCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">TimeColumnConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check time column properties for causal analysis.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;time_column&quot;</span>
    
<div class="viewcode-block" id="TimeColumnCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeColumnConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TimeColumnConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TimeColumnCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimeColumnCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check if time column exists</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">time_col</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span>
        
        <span class="c1"># Check for missing values</span>
        <span class="k">if</span> <span class="n">time_col</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">missing_count</span> <span class="o">=</span> <span class="n">time_col</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time column has </span><span class="si">{</span><span class="n">missing_count</span><span class="si">}</span><span class="s2"> missing values&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">missing_count</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="c1"># Get unique time periods</span>
        <span class="n">unique_times</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">time_col</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">n_periods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_times</span><span class="p">)</span>
        
        <span class="c1"># Check data type</span>
        <span class="n">is_numeric</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">time_col</span><span class="p">)</span>
        <span class="n">is_datetime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">time_col</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">require_numeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time column is not numeric (type: </span><span class="si">{</span><span class="n">time_col</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;actual_type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_col</span><span class="o">.</span><span class="n">dtype</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="c1"># Check sequential periods if required</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">require_sequential</span> <span class="ow">and</span> <span class="n">n_periods</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_numeric</span><span class="p">:</span>
                <span class="c1"># Check for gaps in numeric sequence</span>
                <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">unique_times</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">diffs</span> <span class="o">==</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                        <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Time periods are not evenly spaced&quot;</span><span class="p">,</span>
                        <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                        <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;period_gaps&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unique_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">unique_times</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">diffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> 
                                          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">diffs</span><span class="p">)))]</span>
                        <span class="p">}</span>
                    <span class="p">))</span>
            <span class="k">elif</span> <span class="n">is_datetime</span><span class="p">:</span>
                <span class="c1"># Check for regular intervals in datetime</span>
                <span class="n">time_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">unique_times</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">time_diffs</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                        <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Time periods have irregular intervals&quot;</span><span class="p">,</span>
                        <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                        <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;unique_intervals&quot;</span><span class="p">:</span> <span class="n">time_diffs</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()}</span>
                    <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_periods&quot;</span><span class="p">:</span> <span class="n">n_periods</span><span class="p">,</span>
            <span class="s2">&quot;time_range&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">unique_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span> <span class="k">if</span> <span class="n">n_periods</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;is_numeric&quot;</span><span class="p">:</span> <span class="n">is_numeric</span><span class="p">,</span>
            <span class="s2">&quot;is_datetime&quot;</span><span class="p">:</span> <span class="n">is_datetime</span><span class="p">,</span>
            <span class="s2">&quot;unique_periods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">unique_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span>  <span class="c1"># First 10 periods</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TreatmentPersistenceConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentPersistenceConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TreatmentPersistenceCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">unit_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unit_id&quot;</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">allow_treatment_reversals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether to allow treatment reversals</span></div>



<div class="viewcode-block" id="TreatmentPersistenceCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentPersistenceCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">TreatmentPersistenceConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that treatment is persistent over time (weakly increasing).&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;treatment_persistence&quot;</span>
    
<div class="viewcode-block" id="TreatmentPersistenceCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreatmentPersistenceConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TreatmentPersistenceConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TreatmentPersistenceCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentPersistenceCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check required columns exist</span>
        <span class="n">required_cols</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span>
        <span class="n">missing_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">missing_cols</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Missing required columns for treatment persistence check: </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_columns&quot;</span><span class="p">:</span> <span class="n">missing_cols</span><span class="p">,</span> <span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Sort by unit and time for checking persistence</span>
        <span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">])</span>
        
        <span class="c1"># Check treatment persistence for each unit</span>
        <span class="n">violation_units</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">violation_details</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">unit_id</span> <span class="ow">in</span> <span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="n">unit_data</span> <span class="o">=</span> <span class="n">df_sorted</span><span class="p">[</span><span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span> <span class="o">==</span> <span class="n">unit_id</span><span class="p">]</span>
            <span class="n">treatment_values</span> <span class="o">=</span> <span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_values</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>  <span class="c1"># Skip units with only one observation</span>
            
            <span class="c1"># Check for treatment reversals (1 -&gt; 0)</span>
            <span class="n">reversals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">prev_treatment</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">treatment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span> <span class="n">treatment_values</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">prev_treatment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">prev_treatment</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">treatment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">reversals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">time</span><span class="p">,</span> <span class="n">treatment</span><span class="p">))</span>
                <span class="n">prev_treatment</span> <span class="o">=</span> <span class="n">treatment</span>
            
            <span class="k">if</span> <span class="n">reversals</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">allow_treatment_reversals</span><span class="p">:</span>
                <span class="n">violation_units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit_id</span><span class="p">)</span>
                <span class="n">violation_details</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">unit_id</span><span class="p">,</span>
                    <span class="s2">&quot;reversals&quot;</span><span class="p">:</span> <span class="n">reversals</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># First 3 reversals</span>
                <span class="p">})</span>
        
        <span class="k">if</span> <span class="n">violation_units</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Treatment reversals detected for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">violation_units</span><span class="p">)</span><span class="si">}</span><span class="s2"> units. Treatment should be persistent (weakly increasing).&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;violating_units&quot;</span><span class="p">:</span> <span class="n">violation_units</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span>  <span class="c1"># First 10 units</span>
                    <span class="s2">&quot;violation_details&quot;</span><span class="p">:</span> <span class="n">violation_details</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span>  <span class="c1"># First 5 details</span>
                    <span class="s2">&quot;total_violations&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">violation_units</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;units_checked&quot;</span><span class="p">:</span> <span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span>
            <span class="s2">&quot;violations_found&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">violation_units</span><span class="p">),</span>
            <span class="s2">&quot;allow_reversals&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">allow_treatment_reversals</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="OutcomeVariableConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OutcomeVariableConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for OutcomeVariableCheck.&quot;&quot;&quot;</span>
    <span class="n">outcome_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;outcome&quot;</span>
    <span class="n">min_variation_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span>  <span class="c1"># Minimum variance required</span>
    <span class="n">outlier_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># Standard deviations for outlier detection</span>
    <span class="n">require_numeric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Whether outcome must be numeric</span></div>



<div class="viewcode-block" id="OutcomeVariableCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">OutcomeVariableCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">OutcomeVariableConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that outcome variable is suitable for causal analysis.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;outcome_variable&quot;</span>
    
<div class="viewcode-block" id="OutcomeVariableCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OutcomeVariableConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">OutcomeVariableConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="OutcomeVariableCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.OutcomeVariableCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check if outcome column exists</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Outcome column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Outcome column has no non-missing values&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">]</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Check if outcome is numeric</span>
        <span class="n">is_numeric</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">require_numeric</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_numeric</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Outcome column is not numeric (type: </span><span class="si">{</span><span class="n">outcome</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;actual_type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">dtype</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="k">if</span> <span class="n">is_numeric</span><span class="p">:</span>
            <span class="c1"># Check for sufficient variation</span>
            <span class="n">outcome_var</span> <span class="o">=</span> <span class="n">outcome</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">outcome_var</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_variation_threshold</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Outcome has insufficient variation (variance: </span><span class="si">{</span><span class="n">outcome_var</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">],</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;variance&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome_var</span><span class="p">),</span> <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_variation_threshold</span><span class="p">}</span>
                <span class="p">))</span>
            
            <span class="c1"># Check for extreme outliers</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># Need at least 3 values for outlier detection</span>
                <span class="n">mean_val</span> <span class="o">=</span> <span class="n">outcome</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">std_val</span> <span class="o">=</span> <span class="n">outcome</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
                
                <span class="k">if</span> <span class="n">std_val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Avoid division by zero</span>
                    <span class="n">z_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">outcome</span> <span class="o">-</span> <span class="n">mean_val</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_val</span><span class="p">)</span>
                    <span class="n">outliers</span> <span class="o">=</span> <span class="n">z_scores</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outlier_threshold</span>
                    <span class="n">outlier_count</span> <span class="o">=</span> <span class="n">outliers</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    
                    <span class="k">if</span> <span class="n">outlier_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">outlier_fraction</span> <span class="o">=</span> <span class="n">outlier_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
                        <span class="n">severity</span> <span class="o">=</span> <span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span> <span class="k">if</span> <span class="n">outlier_fraction</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span>
                        
                        <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                            <span class="n">severity</span><span class="o">=</span><span class="n">severity</span><span class="p">,</span>
                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Outcome has </span><span class="si">{</span><span class="n">outlier_count</span><span class="si">}</span><span class="s2"> extreme outliers (</span><span class="si">{</span><span class="n">outlier_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> of data)&quot;</span><span class="p">,</span>
                            <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">],</span>
                            <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                                <span class="s2">&quot;outlier_count&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">outlier_count</span><span class="p">),</span>
                                <span class="s2">&quot;outlier_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outlier_fraction</span><span class="p">),</span>
                                <span class="s2">&quot;threshold_std_devs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outlier_threshold</span>
                            <span class="p">}</span>
                        <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Calculate metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;outcome_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">outcome_column</span><span class="p">,</span>
            <span class="s2">&quot;is_numeric&quot;</span><span class="p">:</span> <span class="n">is_numeric</span><span class="p">,</span>
            <span class="s2">&quot;non_missing_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span>
            <span class="s2">&quot;unique_values&quot;</span><span class="p">:</span> <span class="n">outcome</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="n">is_numeric</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">std</span><span class="p">()),</span>
                <span class="s2">&quot;variance&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">var</span><span class="p">()),</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">outcome</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CausalMethodRequirementsConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CausalMethodRequirementsConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for CausalMethodRequirementsCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">unit_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unit_id&quot;</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">min_pre_periods</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Minimum pre-treatment periods</span>
    <span class="n">min_post_periods</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Minimum post-treatment periods</span>
    <span class="n">min_control_units</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Minimum control units for synthetic control</span>
    <span class="n">min_never_treated_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Minimum fraction of never-treated units</span></div>



<div class="viewcode-block" id="CausalMethodRequirementsCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CausalMethodRequirementsCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">CausalMethodRequirementsConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check data requirements for different causal inference methods.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;causal_method_requirements&quot;</span>
    
<div class="viewcode-block" id="CausalMethodRequirementsCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CausalMethodRequirementsConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">CausalMethodRequirementsConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="CausalMethodRequirementsCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.CausalMethodRequirementsCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check required columns exist</span>
        <span class="n">required_cols</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span>
        <span class="n">missing_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">missing_cols</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Missing required columns: </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_columns&quot;</span><span class="p">:</span> <span class="n">missing_cols</span><span class="p">}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Analyze treatment patterns</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">times</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        
        <span class="c1"># Find treatment timing for each unit</span>
        <span class="n">treatment_start_times</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">never_treated_units</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">unit_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span> <span class="o">==</span> <span class="n">unit</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">)</span>
            <span class="n">treatment_values</span> <span class="o">=</span> <span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            
            <span class="n">first_treatment</span> <span class="o">=</span> <span class="n">treatment_values</span><span class="p">[</span><span class="n">treatment_values</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_treatment</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">treatment_start_times</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit_data</span><span class="p">[</span><span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">never_treated_units</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        
        <span class="n">treated_units</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        
        <span class="c1"># Check for sufficient pre/post periods</span>
        <span class="k">if</span> <span class="n">treatment_start_times</span><span class="p">:</span>
            <span class="n">min_treatment_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">max_treatment_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            
            <span class="n">pre_periods</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">min_treatment_time</span><span class="p">]</span>
            <span class="n">post_periods</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">max_treatment_time</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pre_periods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_pre_periods</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Only </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pre_periods</span><span class="p">)</span><span class="si">}</span><span class="s2"> pre-treatment periods available, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_pre_periods</span><span class="si">}</span><span class="s2"> recommended for robust causal inference&quot;</span><span class="p">,</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;pre_periods_available&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pre_periods</span><span class="p">),</span>
                        <span class="s2">&quot;pre_periods_recommended&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_pre_periods</span>
                    <span class="p">}</span>
                <span class="p">))</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">post_periods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_post_periods</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Only </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">post_periods</span><span class="p">)</span><span class="si">}</span><span class="s2"> post-treatment periods available, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_post_periods</span><span class="si">}</span><span class="s2"> minimum for causal analysis&quot;</span><span class="p">,</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;post_periods_available&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">post_periods</span><span class="p">),</span>
                        <span class="s2">&quot;post_periods_required&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_post_periods</span>
                    <span class="p">}</span>
                <span class="p">))</span>
        
        <span class="c1"># Check for synthetic control feasibility (exactly one treated unit)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treated_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_units</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Synthetic control method: only </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">)</span><span class="si">}</span><span class="s2"> control units available, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_units</span><span class="si">}</span><span class="s2"> recommended&quot;</span><span class="p">,</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;control_units_available&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">),</span>
                        <span class="s2">&quot;control_units_recommended&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_control_units</span><span class="p">,</span>
                        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;synthetic_control&quot;</span>
                    <span class="p">}</span>
                <span class="p">))</span>
        
        <span class="c1"># Check for staggered DiD feasibility</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treated_units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">never_treated_fraction</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">never_treated_fraction</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_never_treated_fraction</span><span class="p">:</span>
                <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                    <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Staggered DiD: only </span><span class="si">{</span><span class="n">never_treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> never-treated units, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_never_treated_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> recommended for robust identification&quot;</span><span class="p">,</span>
                    <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;never_treated_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">never_treated_fraction</span><span class="p">),</span>
                        <span class="s2">&quot;never_treated_recommended&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">min_never_treated_fraction</span><span class="p">,</span>
                        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;staggered_did&quot;</span>
                    <span class="p">}</span>
                <span class="p">))</span>
        
        <span class="c1"># Check for treatment timing variation (all units treated at same time)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">treated_units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;All treated units adopt treatment simultaneously (standard DiD design)&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;design_type&quot;</span><span class="p">:</span> <span class="s2">&quot;simultaneous_adoption&quot;</span><span class="p">}</span>
            <span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Treatment adoption is staggered across units (staggered DiD design)&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;design_type&quot;</span><span class="p">:</span> <span class="s2">&quot;staggered_adoption&quot;</span><span class="p">}</span>
            <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;total_units&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">),</span>
            <span class="s2">&quot;treated_units&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">treated_units</span><span class="p">),</span>
            <span class="s2">&quot;never_treated_units&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">),</span>
            <span class="s2">&quot;never_treated_fraction&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">never_treated_units</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;time_periods&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">),</span>
            <span class="s2">&quot;treatment_times&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">if</span> <span class="n">treatment_start_times</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="s2">&quot;design_type&quot;</span><span class="p">:</span> <span class="s2">&quot;staggered&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_start_times</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;simultaneous&quot;</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TreatmentTimingPatternsConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentTimingPatternsConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TreatmentTimingPatternsCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">unit_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unit_id&quot;</span> 
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">check_simultaneous_adoption</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Check if treatment adoption follows expected patterns</span></div>



<div class="viewcode-block" id="TreatmentTimingPatternsCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TreatmentTimingPatternsCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">TreatmentTimingPatternsConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check treatment timing patterns for causal inference validity.&quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;treatment_timing_patterns&quot;</span>
    
<div class="viewcode-block" id="TreatmentTimingPatternsCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TreatmentTimingPatternsConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TreatmentTimingPatternsConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TreatmentTimingPatternsCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TreatmentTimingPatternsCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check required columns exist</span>
        <span class="n">required_cols</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span>
        <span class="n">missing_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">missing_cols</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Missing required columns: </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_columns&quot;</span><span class="p">:</span> <span class="n">missing_cols</span><span class="p">}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Analyze treatment timing patterns</span>
        <span class="n">df_sorted</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">])</span>
        
        <span class="c1"># Find first and last treatment periods</span>
        <span class="n">treatment_data</span> <span class="o">=</span> <span class="n">df_sorted</span><span class="p">[</span><span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;No treated observations found in data&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>  <span class="c1"># Not necessarily an error</span>
        
        <span class="n">first_treatment_period</span> <span class="o">=</span> <span class="n">treatment_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">last_treatment_period</span> <span class="o">=</span> <span class="n">treatment_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">all_periods</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        
        <span class="c1"># Check if treatment starts/ends in extreme periods</span>
        <span class="k">if</span> <span class="n">first_treatment_period</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">all_periods</span><span class="p">):</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Treatment begins in the first time period, limiting pre-treatment analysis&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;first_treatment_period&quot;</span><span class="p">:</span> <span class="n">first_treatment_period</span><span class="p">,</span> <span class="s2">&quot;first_available_period&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">all_periods</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="k">if</span> <span class="n">last_treatment_period</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">all_periods</span><span class="p">):</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Treatment continues through the last time period, limiting post-treatment analysis&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;last_treatment_period&quot;</span><span class="p">:</span> <span class="n">last_treatment_period</span><span class="p">,</span> <span class="s2">&quot;last_available_period&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">all_periods</span><span class="p">)}</span>
            <span class="p">))</span>
        
        <span class="c1"># Analyze treatment adoption patterns</span>
        <span class="n">treatment_adoptions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
            <span class="n">unit_data</span> <span class="o">=</span> <span class="n">df_sorted</span><span class="p">[</span><span class="n">df_sorted</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">unit_column</span><span class="p">]</span> <span class="o">==</span> <span class="n">unit</span><span class="p">]</span>
            <span class="n">first_treated</span> <span class="o">=</span> <span class="n">unit_data</span><span class="p">[</span><span class="n">unit_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_treated</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">adoption_time</span> <span class="o">=</span> <span class="n">first_treated</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">treatment_adoptions</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="n">adoption_time</span>
        
        <span class="c1"># Check for problematic adoption patterns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">adoption_times</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">unique_adoption_times</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">adoption_times</span><span class="p">))</span>
            
            <span class="c1"># Check if too many units adopt simultaneously</span>
            <span class="k">for</span> <span class="n">adoption_time</span> <span class="ow">in</span> <span class="n">unique_adoption_times</span><span class="p">:</span>
                <span class="n">units_adopting</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit</span> <span class="k">for</span> <span class="n">unit</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">treatment_adoptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="n">adoption_time</span><span class="p">]</span>
                <span class="n">adoption_fraction</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_adopting</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">adoption_fraction</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># More than 50% adopt at same time</span>
                    <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                        <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                        <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">units_adopting</span><span class="p">)</span><span class="si">}</span><span class="s2"> units (</span><span class="si">{</span><span class="n">adoption_fraction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">) adopt treatment at time </span><span class="si">{</span><span class="n">adoption_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;adoption_time&quot;</span><span class="p">:</span> <span class="n">adoption_time</span><span class="p">,</span>
                            <span class="s2">&quot;units_adopting&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_adopting</span><span class="p">),</span>
                            <span class="s2">&quot;adoption_fraction&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">adoption_fraction</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">))</span>
        
        <span class="n">passed</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">issue</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">severity_on_fail</span> <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;treatment_periods&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
            <span class="s2">&quot;first_treatment_period&quot;</span><span class="p">:</span> <span class="n">first_treatment_period</span><span class="p">,</span>
            <span class="s2">&quot;last_treatment_period&quot;</span><span class="p">:</span> <span class="n">last_treatment_period</span><span class="p">,</span>
            <span class="s2">&quot;units_ever_treated&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="p">),</span>
            <span class="s2">&quot;unique_adoption_times&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="k">if</span> <span class="n">treatment_adoptions</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;adoption_pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;staggered&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">treatment_adoptions</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;simultaneous&quot;</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="n">passed</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TimePeriodStandardizationConfig">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TimePeriodStandardizationConfig</span><span class="p">(</span><span class="n">DataValidationConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TimePeriodStandardizationCheck.&quot;&quot;&quot;</span>
    <span class="n">treatment_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;treatment&quot;</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span></div>



<div class="viewcode-block" id="TimePeriodStandardizationCheck">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TimePeriodStandardizationCheck</span><span class="p">(</span><span class="n">DataValidationCheck</span><span class="p">[</span><span class="n">TimePeriodStandardizationConfig</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check and prepare standardization of time periods relative to treatment start.</span>
<span class="sd">    </span>
<span class="sd">    This check:</span>
<span class="sd">    1. Finds the minimum time period where treatment==1 occurs</span>
<span class="sd">    2. Creates a standardized mapping where that period becomes index 0</span>
<span class="sd">    3. Earlier periods get negative indices (-1, -2, etc.)</span>
<span class="sd">    4. Later periods get positive indices (1, 2, etc.)</span>
<span class="sd">    5. Returns a cleaning hint with the value mapping</span>
<span class="sd">    </span>
<span class="sd">    Always requires treatment data to exist - fails with ERROR if no treatment==1 found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;time_period_standardization&quot;</span>
    
<div class="viewcode-block" id="TimePeriodStandardizationCheck.get_default_config">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck.get_default_config">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimePeriodStandardizationConfig</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TimePeriodStandardizationConfig</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TimePeriodStandardizationCheck.validate">
<a class="viewcode-back" href="../../../../api/index.html#pyautocausal.data_validation.checks.causal_checks.TimePeriodStandardizationCheck.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataValidationResult</span><span class="p">:</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Check if required columns exist</span>
        <span class="n">missing_cols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">missing_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">missing_cols</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Required columns not found: </span><span class="si">{</span><span class="n">missing_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;missing_columns&quot;</span><span class="p">:</span> <span class="n">missing_cols</span><span class="p">,</span> <span class="s2">&quot;available_columns&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Check if treatment data exists (treatment==1)</span>
        <span class="n">treatment_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;No treatment data found (no rows where </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="si">}</span><span class="s2">==1). &quot;</span>
                       <span class="s2">&quot;Time period standardization requires treatment data to define the reference point.&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;unique_treatment_values&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Get all unique time periods and find the treatment start period</span>
        <span class="n">unique_times</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">treatment_times</span> <span class="o">=</span> <span class="n">treatment_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">treatment_times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;No valid time periods found for treatment data (all time values are NaN where </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="si">}</span><span class="s2">==1)&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">]</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="c1"># Check for mixed data types in time column</span>
        <span class="n">mixed_types_issue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_mixed_types</span><span class="p">(</span><span class="n">unique_times</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mixed_types_issue</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mixed_types_issue</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try to parse and sort time periods</span>
            <span class="n">parsed_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_time_periods</span><span class="p">(</span><span class="n">unique_times</span><span class="p">)</span>
            <span class="n">parsed_treatment_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_time_periods</span><span class="p">(</span><span class="n">treatment_times</span><span class="p">)</span>
            
            <span class="c1"># Find the minimum treatment time period (this becomes index 0)</span>
            <span class="n">treatment_start_parsed</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">parsed_treatment_times</span><span class="p">)</span>
            
            <span class="c1"># Create mapping from original values to standardized indices</span>
            <span class="n">sorted_times</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">parsed_times</span><span class="p">)</span>
            
            <span class="n">value_mapping</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">original_val</span><span class="p">,</span> <span class="n">parsed_val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">unique_times</span><span class="p">,</span> <span class="n">parsed_times</span><span class="p">):</span>
                <span class="n">value_mapping</span><span class="p">[</span><span class="n">original_val</span><span class="p">]</span> <span class="o">=</span> <span class="n">sorted_times</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">parsed_val</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">parsed_val</span> <span class="o">==</span> <span class="n">treatment_start_parsed</span><span class="p">:</span>
                    <span class="n">treatment_start_original</span> <span class="o">=</span> <span class="n">original_val</span>
            

            <span class="c1"># Create cleaning hint</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">...data_cleaning.hints</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardizeTimePeriodHint</span>
            <span class="n">cleaning_hint</span> <span class="o">=</span> <span class="n">StandardizeTimePeriodHint</span><span class="p">(</span>
                <span class="n">time_column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">,</span>
                <span class="n">value_mapping</span><span class="o">=</span><span class="n">value_mapping</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;total_periods&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_times</span><span class="p">),</span>
                    <span class="s2">&quot;pre_treatment_periods&quot;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value_mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">value_mapping</span><span class="p">[</span><span class="n">treatment_start_original</span><span class="p">]),</span>
                    <span class="s2">&quot;post_treatment_periods&quot;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value_mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;=</span> <span class="n">value_mapping</span><span class="p">[</span><span class="n">treatment_start_original</span><span class="p">]),</span>
                    <span class="s2">&quot;original_treatment_start&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">treatment_start_original</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>
            
            <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;time_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">,</span>
                <span class="s2">&quot;treatment_column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">treatment_column</span><span class="p">,</span>
                <span class="s2">&quot;total_periods&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_times</span><span class="p">),</span>
                <span class="s2">&quot;standardized_range&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">value_mapping</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="nb">max</span><span class="p">(</span><span class="n">value_mapping</span><span class="o">.</span><span class="n">values</span><span class="p">())],</span>
                <span class="s2">&quot;value_mapping_sample&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">value_mapping</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># First 5 for display</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">issues</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="p">[</span><span class="n">cleaning_hint</span><span class="p">])</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Failed to parse time periods in column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error_type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s2">&quot;sample_values&quot;</span><span class="p">:</span> <span class="n">unique_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()}</span>
            <span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_result</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">issues</span><span class="p">)</span></div>

    
    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_time_periods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse time periods into comparable values.</span>
<span class="sd">        </span>
<span class="sd">        Handles multiple formats:</span>
<span class="sd">        - Datetime strings (parsed with pd.to_datetime)</span>
<span class="sd">        - Datetime objects</span>
<span class="sd">        - Numeric values (treated as periods)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">continue</span>
                
            <span class="c1"># Try numeric first (integers, floats)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">parsed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
            
            <span class="c1"># Try datetime parsing</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s1">&#39;strftime&#39;</span><span class="p">):</span>
                    <span class="n">dt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="c1"># Convert to ordinal for comparison (days since year 1)</span>
                    <span class="n">parsed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">toordinal</span><span class="p">())</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">pass</span>
            
            <span class="c1"># If nothing else works, try to convert to string and then float</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">parsed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to parse time period value: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> (type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">parsed</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_for_mixed_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if time column contains mixed data types.</span>
<span class="sd">        </span>
<span class="sd">        Returns ValidationIssue if mixed types are detected, None otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="c1"># Categorize types</span>
        <span class="n">numeric_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">string_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">datetime_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">other_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="k">continue</span>
                
            <span class="n">val_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            
            <span class="c1"># Categorize by type family</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="n">numeric_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val_type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># Check if string could be a date</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="n">string_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;date_string&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">string_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s1">&#39;strftime&#39;</span><span class="p">):</span>  <span class="c1"># datetime-like objects</span>
                <span class="n">datetime_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val_type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">val_type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        
        <span class="c1"># Count how many different type categories we have</span>
        <span class="n">type_families</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">numeric_types</span><span class="p">:</span>
            <span class="n">type_families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numeric (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">numeric_types</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">string_types</span><span class="p">:</span>
            <span class="n">type_families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;string (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">string_types</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">datetime_types</span><span class="p">:</span>
            <span class="n">type_families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;datetime (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">datetime_types</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other_types</span><span class="p">:</span>
            <span class="n">type_families</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;other (</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">other_types</span><span class="p">))</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        
        <span class="c1"># Error if we have mixed type families</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_families</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">sample_values</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
            
            <span class="k">return</span> <span class="n">ValidationIssue</span><span class="p">(</span>
                <span class="n">severity</span><span class="o">=</span><span class="n">ValidationSeverity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="si">}</span><span class="s2">&#39; contains mixed data types: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">type_families</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
                       <span class="s2">&quot;All time values should be of the same type family (all numeric, all date strings, or all datetime objects).&quot;</span><span class="p">,</span>
                <span class="n">affected_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">time_column</span><span class="p">],</span>
                <span class="n">details</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;mixed_type_families&quot;</span><span class="p">:</span> <span class="n">type_families</span><span class="p">,</span>
                    <span class="s2">&quot;sample_values&quot;</span><span class="p">:</span> <span class="n">sample_values</span><span class="p">,</span>
                    <span class="s2">&quot;total_unique_values&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_values</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>
        
        <span class="k">return</span> <span class="kc">None</span> </div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Nicholas Topousis, Yogam Tchokni.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>